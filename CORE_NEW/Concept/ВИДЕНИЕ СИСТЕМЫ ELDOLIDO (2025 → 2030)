# ВИДЕНИЕ СИСТЕМЫ ELDOLIDO (2025 → 2030)

Документ фиксирует текущее архитектурное видение ядра Eldolido:  
контекст-машина, граф, оркестратор, EventStore, внешние события, прерывания, сценарии и эволюционность системы.

---

# 1. ОБЩАЯ КОНЦЕПЦИЯ

Eldolido — это **AI-операционная система коммуникаций и процессов сервиса**, построенная вокруг трёх ключевых элементов:

1. **Контекст-машина** — извлечение смысла из любого сообщения.  
2. **Граф** — модель предметного мира (клиент → устройство → поломка → заявка).  
3. **Оркестратор** — исполнитель сценариев и реакций, который решает, что делать дальше.

Внешний интерфейс для клиента остаётся привычным (мессенджеры, звонки), но система превращает эти каналы в интеллект, работающий 24/7.

---

# 2. КОНТЕКСТ-МАШИНА

### 2.1. Задачи
- Разбирать каждое входящее сообщение клиента.  
- Извлекать сущности:
  - тип сообщения (приветствие, вопрос, прощание);
  - модель телефона;
  - тип поломки;
  - детали неисправности;
  - намерение (ремонт, консультация, покупка);
  - второстепенные фрагменты (эмоции, личные факты).

### 2.2. Результат работы
Контекст-машина возвращает **структурированный набор фактов**, которые:

- обновляют граф,
- передаются оркестратору,
- логируются в EventStore.

Она не принимает решений — только **понимает** сообщение.

---

# 3. ГРАФ (MODEL GRAPH)

### 3.1. Зачем граф
- Хранить реальное состояние мира:  
  клиент → устройства → поломки → заявки → запчасти → записи → события.
- Удерживать **фокус диалога** (на каком устройстве / на какой поломке мы сейчас).
- Избежать путаницы при нелинейных разговорах (клиент прыгает между проблемами).

### 3.2. Состав графа
Узлы:
- `Client`
- `Device`
- `Issue`
- `RepairOrder`
- `Appointment`
- `PartOrder`
- `StaffMember`
- (+ дополнительные доменные сущности)

Связи:
- `client-owns-device`
- `device-has-issue`
- `issue-belongs-to-order`
- `order-needs-part`
- `order-has-appointment`
- и т.п.

### 3.3. Фокус
`focus_pointer` указывает на активную цепочку:
7. ВНЕШНИЕ СОБЫТИЯ КАК ТРИГГЕРЫ

Независимые от диалога ситуации должны вмешиваться в процесс:

Запчасть задержалась (PartDeliveryDelayed)

Привезли не ту деталь (PartWrongDelivered)

Мастер заболел (StaffSickReported)

Клиент перенёс запись (AppointmentRescheduled)

Система получила платёж (PaymentReceived)

Каждое такое событие запускает interrupt-флоу.

8. ДВА УРОВНЯ КОНТЕКСТА: ЖЁСТКИЙ И МЯГКИЙ
8.1. Жёсткий контекст

устройство,

поломка,

заявка,

даты,

статусы.

8.2. Мягкий контекст

приветствия/прощания,

smalltalk,

эмоции,

личные факты,

отношение клиента,

тон общения.

9. РОЛЬ AI В СИСТЕМЕ

AI:

понимает сообщение,

формирует ответы,

подсказывает оркестратору нужные поля,

помогает вести клиента по сценарию.

AI ≠ логика.
Логика — в оркестраторе и графе.

10. ЭВОЛЮЦИОННОСТЬ ДО 2030

Архитектура позволяет:

добавлять новые отрасли через изменение DSL,

подключать голосовые каналы,

улучшать модели без переписывания ядра,

внедрять автогенерацию сценариев,

усиливать автономность системы.

11. ИТОГОВАЯ КАРТИНА
Client Message
      ↓
 EventStore → Projectors → Context State → Orchestrator → Action/AI Response
                          ↑
                       Graph
                          ↑
                External Business Events

12. MVP ГОТОВОСТЬ

контекст-машина: базовое NER + намерения;

простой граф: Client–Device–Issue;

простой EventStore: таблица events;

упрощённый оркестратор: current_pipeline, current_step;

1–2 сценария + 1 interrupt;

минимальный DSL.


---
