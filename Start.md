# START - Context for Continuing Work

## FIRST ‚Äî Sync

**If reading this file SECOND time after git pull ‚Äî SKIP this block and go to next section!**

```bash
cd "C:/Users/User/Documents/Eldoleado"
git pull
```

After git pull ‚Äî REREAD this file from the beginning (Start.md), starting from the next section (skipping this sync block to avoid loops).

---

## Last update date and time
**December 11, 2025, 23:30 (UTC+4)**

---

## CORE AI ‚Äî –ö–û–ù–¶–ï–ü–¶–ò–Ø –†–ê–ó–†–ê–ë–û–¢–ê–ù–ê

### –ö–ª—é—á–µ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ

```
–í–°–Ø –õ–û–ì–ò–ö–ê CORE AI = –ì–†–ê–§ + –ü–†–û–ú–ü–¢–´
‚îú‚îÄ‚îÄ –°—Ö–µ–º–∞ —Å–ª–æ—Ç–æ–≤ (—á—Ç–æ —Å–æ–±–∏—Ä–∞—Ç—å)
‚îú‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∫–∞–∫ –≤—ã–≤–æ–¥–∏—Ç—å)
‚îú‚îÄ‚îÄ –≠—Ç–∞–ø—ã –≤–æ—Ä–æ–Ω–∫–∏ (stages)
‚îú‚îÄ‚îÄ –¢—Ä–∏–≥–≥–µ—Ä—ã (conditions ‚Üí actions)
‚îî‚îÄ‚îÄ –ü—Ä–æ–º–ø—Ç—ã (—Ç–µ–∫—Å—Ç—ã)

–û–¢–õ–ò–ß–ò–ï –í–ï–†–¢–ò–ö–ê–õ–ï–ô = –¢–û–õ–¨–ö–û TOOLS
–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–¥–∏–Ω, –ª–æ–≥–∏–∫–∞ –æ–¥–Ω–∞ ‚Äî Context Lines
```

---

### –ú–æ–¥–µ–ª—å "Context Lines"

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      CONTEXT                            ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  Line 0: ‚óè‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã  (cursor=3, waiting)            ‚îÇ
‚îÇ  Line 1: ‚óè‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚úì  (done)                         ‚îÇ
‚îÇ  Line 2: ‚óè‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã  (cursor=1, active) ‚Üê focus     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  ‚óè = filled, ‚óã = empty, ‚úì = complete                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Line = intake —Å —Å–ª–æ—Ç–∞–º–∏ [device, symptom, owner, price]
Cursor = –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å
Focus = –∞–∫—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è
Waiting = –ª–∏–Ω–∏–∏ —Å –æ–±—Ä—ã–≤–∞–º–∏
```

### –ê–ª–≥–æ—Ä–∏—Ç–º (–í–°–Ø –õ–û–ì–ò–ö–ê)

```
1. –ü–û–õ–£–ß–ò–¢–¨ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

2. AI EXTRACT ‚Äî –≤—ã—Ç–∞—â–∏—Ç—å –í–°–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–µ –ø–æ –æ–¥–Ω–æ–º—É!)
   {device: ?, symptom: ?, owner: ?, ...}

3. –ê–ù–ê–õ–ò–ó:
   - –ù–æ–≤—ã–π owner/device? ‚Üí CREATE –ª–∏–Ω–∏—é
   - Owner/device –¥—Ä—É–≥–æ–π –ª–∏–Ω–∏–∏? ‚Üí SWITCH focus
   - –ó–∞–ø–æ–ª–Ω–∏—Ç—å –í–°–ï –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
   - –î–≤–∏–Ω—É—Ç—å cursor

4. DERIVE ‚Äî –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º—ã–µ (symptom ‚Üí repair ‚Üí price)

5. TRIGGERS ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è, –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è

6. –ü–†–û–í–ï–†–ò–¢–¨:
   - –õ–∏–Ω–∏—è done? ‚Üí —É–±—Ä–∞—Ç—å –∏–∑ waiting
   - –í—Å–µ done? ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
   - –ï—Å—Ç—å waiting? ‚Üí switch –Ω–∞ –ø–µ—Ä–≤—É—é

7. –°–ü–†–û–°–ò–¢–¨ ‚Äî —Å–ª–æ—Ç –Ω–∞ cursor –∞–∫—Ç–∏–≤–Ω–æ–π –ª–∏–Ω–∏–∏
```

---

### –≠—Ç–∞–ø—ã –≤–æ—Ä–æ–Ω–∫–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –≠–¢–ê–ü 1: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö                                    ‚îÇ
‚îÇ  slots: [device, symptom, owner, price]                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –≠–¢–ê–ü 2: –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è                                    ‚îÇ
‚îÇ  slots: [offer_shown] + triggers                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –≠–¢–ê–ü 3: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ                                   ‚îÇ
‚îÇ  slots: [conditions_ok, ready_to_book]                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –≠–¢–ê–ü 4: –ó–∞–ø–∏—Å—å                                         ‚îÇ
‚îÇ  slots: [date, time, name, phone]                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –≠–¢–ê–ü 5: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ                                  ‚îÇ
‚îÇ  slots: [confirmed] ‚Üí INTAKE CREATED                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### –¢—Ä–∏–≥–≥–µ—Ä—ã –≤ –≥—Ä–∞—Ñ–µ

```cypher
(:Trigger {stage: "presentation", conditions: {device_brand: "Apple", repair: "battery_replace"}})
  -[:EXECUTES]->
(:Action {type: "send_file", file: "battery_care.pdf"})
```

---

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å

```
1000 tenants √ó 50 –¥–∏–∞–ª–æ–≥–æ–≤ √ó 40 —Å–æ–æ–±—â–µ–Ω–∏–π = 2M msg/–¥–µ–Ω—å

Python FastAPI async: 2-3 –ø–æ–¥–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
OpenRouter Qwen3-30B: paid tier, –Ω–µ—Ç –ª–∏–º–∏—Ç–∞

–°—Ç–æ–∏–º–æ—Å—Ç—å AI:
- Extract (–¥–µ—à—ë–≤–∞—è –º–æ–¥–µ–ª—å): ~$5/–¥–µ–Ω—å
- Response (—É–º–Ω–∞—è –º–æ–¥–µ–ª—å): ~$74/–¥–µ–Ω—å
- –ò—Ç–æ–≥–æ: ~$2.40/tenant/–º–µ—Å—è—Ü
```

---

## PLAN FILE

**–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è:** `.claude/plans/snazzy-prancing-piglet.md`

---

## NEXT STEPS (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

### –§–∞–∑–∞ 1: Context Lines –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Line, Context (Python)
2. AI Extract –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ö–µ–º—ã
3. –õ–æ–≥–∏–∫–∞ —Ä–∞—Å–∫–∏–¥—ã–≤–∞–Ω–∏—è –ø–æ –ª–∏–Ω–∏—è–º
4. Focus / waiting / cursor
5. Derive –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª–æ—Ç–æ–≤

### –§–∞–∑–∞ 2: –≠—Ç–∞–ø—ã –≤–æ—Ä–æ–Ω–∫–∏
1. Stage schema –≤ –≥—Ä–∞—Ñ–µ
2. –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
3. –°–ª–æ—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

### –§–∞–∑–∞ 3: –¢—Ä–∏–≥–≥–µ—Ä—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è
1. Trigger schema –≤ –≥—Ä–∞—Ñ–µ
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ conditions
3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ actions

### –§–∞–∑–∞ 4: –í–æ—Ä–∫–µ—Ä—ã
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—Ç–∞–≤–∏—Ç—å –≤–æ—Ä–∫–µ—Ä—ã
2. –û–ø–∏—Å–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –ø—É–Ω–∫—Ç–∞ –∫ –ø—É–Ω–∫—Ç—É
3. –°–≤—è–∑–∞—Ç—å —ç—Ç–∞–ø—ã –≤ –µ–¥–∏–Ω—ã–π flow

---

## CURRENT PROJECT STATUS

### Strategy defined

**Product:** Dialog-centric CRM for service centers

**Philosophy:** "People talk. Machine keeps records."

**MVP Vertical:** Phone Repair + Buy/Sell (trade-in, used)

**WOW-effect:** "No lost customers" ‚Äî AI responds at 11 PM, schedules for tomorrow

---

## WHAT'S DONE ‚Äî FULL HISTORY

### Session 11.12.2025 (night) ‚Äî CORE AI Concept ‚úÖ

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è Core AI:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|----------|--------|
| Context Lines | –ú–æ–¥–µ–ª—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (lines, cursor, focus, waiting) | ‚úÖ |
| Stages | –≠—Ç–∞–ø—ã –≤–æ—Ä–æ–Ω–∫–∏ (5 —ç—Ç–∞–ø–æ–≤) | ‚úÖ |
| Triggers | –£—Å–ª–æ–≤–∏—è ‚Üí –¥–µ–π—Å—Ç–≤–∏—è (–≤ –≥—Ä–∞—Ñ–µ) | ‚úÖ |
| Scaling | 2-3 –ø–æ–¥–∞ –¥–ª—è 1000 tenants | ‚úÖ |
| Cost | ~$2.40/tenant/–º–µ—Å—è—Ü –Ω–∞ AI | ‚úÖ |

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ Neo4j:**
- DeviceModel: iPhone 12 Pro, iPhone 14
- RepairType: display, battery, charging
- Symptom ‚Üí RepairType (—Å –∞–ª–∏–∞—Å–∞–º–∏)
- Price: iPhone 12 Pro (8500, 2800, 2500)

**Git commit:** `98349ec` ‚Äî Core AI: Inference-based logic design + Neo4j test data

---

### Session 12.11.2025 (day) ‚Äî MCP Contours Architecture + AI Tool

**4-–∫–æ–Ω—Ç—É—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
MCP Channels ‚Üí Input (8771) ‚Üí Client (8772) ‚Üí Core (n8n) ‚Üí Graph (8773)
                                                    ‚Üì
                                              AI Tool (8774)
```

**MCP —Å–µ—Ä–≤–∏—Å—ã:**

| Service | Port | Purpose | Status |
|---------|------|---------|--------|
| Input Contour | 8771 | Ingest + Redis queue | üìù Documented |
| Client Contour | 8772 | Tenant/Client/Dialog | ‚úÖ Code ready |
| Graph Tool | 8773 | Neo4j proxy | üìù Documented |
| AI Tool | 8774 | Extract + Chat | ‚úÖ Created |

---

### Session 12.11.2025 (night) ‚Äî Commercial Strategy + ROADMAP

**Created:**
- `NEW/ROADMAP.md` (~1200 lines) ‚Äî Killer features, AI tools
- `NEW/ARCHITECTURE_SYNC.md` (~550 lines) ‚Äî Architecture mapping

---

## SERVERS

### MCP Contours:

| Service | IP | Port | Status |
|---------|----|------|--------|
| Input Contour | 45.144.177.128 | 8771 | üìù Documented |
| Client Contour | 45.144.177.128 | 8772 | ‚úÖ Code ready |
| Graph Tool | 45.144.177.128 | 8773 | üìù Documented |
| AI Tool | 45.144.177.128 | 8774 | ‚úÖ Created |

### Infrastructure:

| Server | IP/URL | Port | Purpose |
|--------|--------|------|---------|
| n8n | n8n.n8nsrv.ru | 443 | Workflow automation |
| Neo4j | 45.144.177.128 | 7474/7687 | Graph database |
| PostgreSQL | 185.221.214.83 | 6544 | Main database |
| Redis (RU) | 45.144.177.128 | 6379 | Queues |

---

## DATABASE CONNECTIONS

```
PostgreSQL: postgresql://supabase_admin:Mi31415926pS@185.221.214.83:6544/postgres
Neo4j: bolt://neo4j:Mi31415926pS@45.144.177.128:7687
Redis (RU): redis://:Mi31415926pSss!@45.144.177.128:6379
```

---

## KEY DOCUMENTS

**On session start:**
1. This file (Start.md)
2. `.claude/plans/snazzy-prancing-piglet.md` ‚Äî Core AI concept
3. `NEW/ROADMAP.md` ‚Äî killer features
4. `CORE_NEW/docs/05_AI_ARCHITECTURE.md` ‚Äî 7 levels

---

## QUICK COMMANDS

```bash
# Neo4j test data check
ssh root@45.144.177.128 "docker exec neo4j cypher-shell -a 'bolt+ssc://localhost:7687' -u neo4j -p 'Mi31415926pS' 'MATCH (n) RETURN labels(n), count(n)'"

# Redis queue check
ssh root@45.144.177.128 'docker exec redis redis-cli --no-auth-warning -a Mi31415926pSss! LLEN "ai_extraction_queue"'

# Update context
python scripts/update_core_context.py
```

---

**Before ending session:** update Start.md and Stop.md, git push
